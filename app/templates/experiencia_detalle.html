{% extends "base.html" %}

{% block title %}{{ experiencia.nombre }}{% endblock %}

{% block styles %}
<style>
    .experiencia-imagen {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .precio-tag {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--greenway-primary);
    }
    .btn-reservar {
        background-color: var(--greenway-accent);
        border: none;
        color: white;
        font-weight: 600;
        padding: 12px 25px;
        font-size: 1.1rem;
    }
    .btn-reservar:hover {
        background-color: #27a33e; /* Un verde más oscuro para el hover */
        color: white;
    }
</style>
{% endblock %}


{% block content %}
<div class="container my-5">
    
    {% if experiencia %}
    <div class="row">
        <div class="col-lg-7 mb-4">
            <img src="{{ experiencia.imagen_url }}" class="experiencia-imagen" alt="{{ experiencia.nombre }}">
        </div>

        <div class="col-lg-5">
            <h1 class="display-5 fw-bold">{{ experiencia.nombre }}</h1>
            
            {% if experiencia.nombre_propietario %}
                <p class="lead text-muted">Registrado por: {{ experiencia.nombre_propietario }}</p>
            {% endif %}
            
            <hr class="my-4">

            <p class="fs-5">{{ experiencia.descripcion }}</p>

            <div class="d-flex justify-content-between align-items-center my-4">
                <span class="precio-tag">
                    ${{ "{:,.0f}".format(experiencia.precio_noche) }} COP
                </span>
                <span class="text-muted">/ por noche</span>
            </div>

            {% set wpp_number = '573001234567' %}
            {% set wpp_message = "Hola, estoy interesado en reservar la experiencia: " ~ experiencia.nombre %}
            
            <a href="https://wa.me/{{ wpp_number }}?text={{ wpp_message|urlencode }}" 
               target="_blank" 
               class="btn btn-reservar w-100">
                <i class="fab fa-whatsapp"></i> Reservar por WhatsApp
            </a>
            
            
            {% if session['role'] == 'admin' or (experiencia.propietario_id == session['user_id']) %}

                <hr class="my-4">
                <h5 class="text-muted">Panel de Propietario</h5>
                
                <div class="d-grid gap-2">
                    <a href="{{ url_for('admin_edit_experiencia', experiencia_id=experiencia_id) }}" 
                       class="btn btn-outline-primary">
                        Editar esta Experiencia
                    </a>
                    
                    <form action="{{ url_for('admin_delete_experiencia', experiencia_id=experiencia_id) }}" 
                          method="POST" 
                          class="d-grid"
                          onsubmit="return confirm('¿Estás seguro de que quieres ELIMINAR esta experiencia? Esta acción no se puede deshacer.');">
                        
                        <button type="submit" class="btn btn-outline-danger">
                            Eliminar esta Experiencia
                        </button>
                    </form>
                </div>
                
            {% endif %}
            </div>
    </div>
    {% else %}
    <div class="text-center">
        <h2>Oops!</h2>
        <p>Parece que esta experiencia no existe o no se pudo cargar.</p>
        <a href="{{ url_for('home') }}" class="btn btn-primary">Volver al Inicio</a>
    </div>
    {% endif %}

</div>
{% endblock %}